\documentclass{sydeStyle}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{subfig}
\usepackage{listings}
\DeclareGraphicsExtensions{.png}
\graphicspath{{./files/}}

\coursecode{352}
\prof{Alexander Wong}
\title{Lab 1 Report\\
Fundamentals of Image Processing}
\date{\today}

\author{Andrew Cameron, 20252410}
\authortwo{Simon Ruggier, 20165414}

\begin{document}

\maketitle

\section*{Introduction}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi quis cursus
sapien. Integer id ultrices augue. Donec quis arcu at odio dignissim
tincidunt a ac nibh. Sed condimentum tortor in odio auctor luctus.
Phasellus vitae aliquet nibh. Pellentesque felis lorem, rutrum euismod
cursus at, mattis imperdiet ipsum. Etiam eget auctor mauris. Vestibulum
mollis libero eget leo pretium nec eleifend tortor mattis. Aliquam aliquet,
tellus et hendrerit porttitor, magna ante congue justo, vulputate mollis
quam purus vitae felis. In hac habitasse platea dictumst.

\section*{Digital Zooming}
% TODO: make this an ordered list
% 1.
%All of the up-sampled images were clearly inferior to the original, although
%some were better than others.  Nearest neighbour is clearly the worst;
%the resulting image is very blocky and appears identical to the down-sampled
%image.  Bilinear interpolation is much better, although quite blurry compared
%to the original, whereas bicubic interpolation, although still blurry compared
%with the original, has clearer features than bilinear.

% 2. How do the different methods compare to each other in terms of PSNR as well as visual quality?  Why?
\begin{table}
	\centering
	\begin{tabular}{| l | r | r |}
		\hline
		\multicolumn{3}{|c|}{PSNR (dB)} \\ \hline
		& Lena & Cameraman \\ \hline
		Nearest Neighbour & 32.752 & 31.314 \\ \hline
		Bilinear Interpolation & 32.746 & 30.978 \\ \hline
		Bicubic Interpolation & 33.156 & 31.271 \\
		\hline
	\end{tabular}
	\caption{Peak signal-to-noise for Lena and Cameraman}
	\label{tab:psnr}
\end{table}
%%%% simple table - PSNR (dB)
%%%% column 1: Lena
% Nearest Neighbour: 32.752
% Bilinear Interpolation: 32.746
% Bicubic Interpolation: 33.156
%%%% column 2: cameraman
% Nearest Neighbour: 31.314
% Bilinear Interpolation: 30.978
% Bicubic Interpolation: 31.271
2. None of the up-sampled images are as good as the original images.  Nearest
neighbour upsampling produces blocky images, whereas bilinear and
bicubic interpolation both produce slightly better images, although both are
blurred.  Bicubic interpolation appears slightly less blurred than bilinear.
The PSNR values, as shown in Table \ref{tab:psnr}, are quite close for all
three methods; no algorithm comes out a clear winner, because all three
behave similarly: they upsample by using information from nearby pixels.

% 3. What parts of the image seems to work well using these digital zooming methods? What parts of the image doesnâ€™t? Why?

% 4. Compare the zooming results between Lena and Cameraman. Which image results in higher PSNR?  Which image looks better when restored to the original resolution using digital zooming methods?  Why?

% 5. What does the PSNR tell you about each of the methods? Does it reflect what is observed visually?

\section*{Discrete Convolution for Image Processing}
 \begin{figure}
	\begin{center}
		\subfloat[Lena]{\label{fig:lena_orig}\includegraphics[width=0.2\textwidth]{lena_orig.png}}
		\subfloat[Lena$*h1$]{\label{fig:lena_conv_h1}\includegraphics[height=0.2\textwidth]{lena_conv_h1.png}}
		\subfloat[Lena$*h2$]{\label{fig:lena_conv_h2}\includegraphics[width=0.2\textwidth]{lena_conv_h2.png}}
		\subfloat[Lena$*h3$]{\label{fig:lena_conv_h3}\includegraphics[height=0.2\textwidth]{lena_conv_h3.png}}
		\subfloat[absolute value of Lena$*h3$]{\label{fig:lena_conv_h3_abs}\includegraphics[height=0.2\textwidth]{lena_conv_h3_abs.png}}
	\end{center}
	\caption{Lena, convoluted with various impulse functions}
	\label{SummingAmp2}
\end{figure}
In order to experiment with convolution in the context of image processing,
three impulse functions, $h1$, $h2$, and $h3$ were convolved with the standard
Lena test image:
\begin{align*}
	h1 & = \begin{bmatrix}\frac{1}{6} & \frac{1}{6} & \frac{1}{6} & \frac{1}{6}
		& \frac{1}{6} & \frac{1}{6}\end{bmatrix} \\
	h2 & = \begin{bmatrix}\frac{1}{6} & \frac{1}{6} & \frac{1}{6} & \frac{1}{6}
		& \frac{1}{6} & \frac{1}{6}\end{bmatrix}^T \\
	h3 & = \begin{bmatrix}-1 & 1\end{bmatrix}
\end{align*}

Because $h1$ is a horizontal vector, performing a 2D convolution with it should
incorporate information into each pixel from horizontal neighbours of that pixel,
resulting in a horizontal blur effect; figure \ref{fig:lena_conv_h1} confirms this.

The second impulse function, shown convoluted with Lena in figure
\ref{fig:lena_conv_h2}, is a transposed version of the first.  As such, it would
be expected that it would result in a vertical blurring effect, which it does.

The third impulse function results in a much different effect.
It is also 1 dimensional, acting in the horizontal direction, but it simply
subtracts the right neighbouring pixel from each pixel.
Thus, the brightness of each pixel is proportional to the difference between it
and its right neighbour.
This results in a crude edge magnifying transformation, which can be seen in
figure \ref{fig:lena_conv_h3}.
However, observe that if the input image range is $[0,1]$, the output image will
be $[-1,1]$.
As such, some of the output is negative, and by default, this gets saturated to
black when the output is displayed.
If each pixel in the output image is converted to its absolute value, the result
in figure \ref{fig:lena_conv_h3_abs} is obtained.

Given these results, it is clear that convolution can be a convenient way to
express operations that linearly transform pixels using information from their
neighbours.
Such operations are widely applicable to image processing.

\section*{Fourier Analysis}
% TODO: make this an ordered list
% 1. What can you say about the general distribution of energy in the Fourier spectra? Why?

% 2. What characteristics about the test image can you infer from the Fourier spectra?

% 3. How did the Fourier spectra change from the original image (before rotation)?

% 4. What conclusions and observations can be made about image characteristics based on the Fourier spectra of both original image and the rotated image?

% 5. Describe how the reconstructed image from the amplitude component look like? What image characteristics does the amplitude component capture?

% 6. Describe how the reconstructed image from the phase component look like? What image characteristics does the phase component capture?


\section*{Point Operations for Image Enhancement}
Various pixel operations can be used to enhance the contrast of an image.
To study this, a low contrast image of a tire was subjected to various per-pixel
operations.
In order to evaluate the effects of these operations, histograms for each output
image are compared with the original image.
Histograms are a plot of how many pixels have a given intensity value, with
intensity on the x-axis and number of pixels on the y-axis.
This is useful in evaluating contrast enhancement of various operations because
it provides a visual representation of the global contrast of an image.
 \begin{figure}
	\begin{center}
		\subfloat[Image]    {\includegraphics[height=0.42\textwidth]{tire_orig.png}}
		\subfloat[Histogram]{\includegraphics[height=0.42\textwidth]{tire_orig_hist.pdf}}
	\end{center}
	\caption{Tire image}
\end{figure}

The histogram for the original image shows that most of the pixels in the image
are concentrated in the low intensities, which results in low contrast, with
most of the image looking dark.

 \begin{figure}
	\begin{center}
		\subfloat[Image]    {\includegraphics[height=0.42\textwidth]{tire_negative.png}}
		\subfloat[Histogram]{\includegraphics[height=0.42\textwidth]{tire_negative_hist.pdf}}
	\end{center}
	\caption{Tire image after negative transform}
\end{figure}
As a first test, a negative transform is applied to the image.
This causes all dark pixels to become bright, and bright pixels to become dark.
Because most pixels in the input image were dark, the output image has mostly
bright pixels.
The histogram is flipped horizontally, and most pixels are within a small,
bright range of intensities, resulting in no improvement in contrast.

 \begin{figure}
	\begin{center}
		\subfloat[Image]    {\includegraphics[height=0.42\textwidth]{tire_gamma_13.png}}
		\subfloat[Histogram]{\includegraphics[height=0.42\textwidth]{tire_gamma_13_hist.pdf}}
	\end{center}
	\caption{Tire image after power-law transformation with $\gamma=1.3$}
\end{figure}
Next, power-law transformations are tested, in which each pixel is transformed
according to the equation:
\begin{displaymath}
	I_{out} = I_{in}^\gamma
\end{displaymath}
Two values for the gamma term $\gamma$ are tested, $1.3$ and $0.5$.
Because the range of values being transformed is between zero and one, a gamma
term that is less than one nonlinearly shifts the intensity distribution toward
brighter values, while a gamma term above one shifts the distribution to darker
values.
Because the image already has a very dark intensity distribution, adjusting with
a gamma term of 1.3 squashes the intensity distribution further, lowering
contrast and making the image look darker, with features that are harder to
distinguish in the low contrast.
 \begin{figure}
	\begin{center}
		\subfloat[Image]    {\includegraphics[height=0.42\textwidth]{tire_gamma_05.png}}
		\subfloat[Histogram]{\includegraphics[height=0.42\textwidth]{tire_gamma_05_hist.pdf}}
	\end{center}
	\caption{Tire image after power-law transformation with $\gamma=0.5$}
\end{figure}
Conversely a gamma term of 0.5 causes the intensity distribution to be brighter
overall, and spreads out the intensities of the dark pixels in the image (i.e.
most of them), thus improving contrast.
The resulting image is much clearer, and features are easier to distinguish.
Given the above points, the gamma term of 0.5 is a better choice for this image.
If the intensity distribution was highest in the bright intensities, or if
working with the negative transformed version of this image, the gamma term of
1.3 would have been a better choice for improving contrast.

 \begin{figure}
	\begin{center}
		\subfloat[Image]    {\includegraphics[height=0.42\textwidth]{tire_histeq_256.png}}
		\subfloat[Histogram]{\includegraphics[height=0.42\textwidth]{tire_histeq_256_hist.pdf}}
	\end{center}
	\caption{Tire image after histogram equalization}
\end{figure}
Finally, histogram equalization is performed on the image.
Although ideally, this equalization would produce a flat histogram, this is not
possible with discrete intensity values, because all pixels with the same
intensity are transformed equally.
Thus, spikes corresponding to above-average intensities on the histogram are
merely shifted along the x-axis.
However, it is possible to map multiple input intensity values to the same
output intensity, throwing out some information for the few pixels that are
spread out in the bright part of the intensity distribution.
Because most pixel intensities are densely distributed in the darker
intensities, this transformation causes a big increase in brightness for the
darker pixels in the image, which makes the output image look unrealistically
bright.

\section*{Conclusions}
Convolution of an image was demonstrated with 3 different impulse functions,
illustrating that convolution can have very distinct effects depending on the
chosen impulse function.

Various methods for improving contrast were performed and compared, using a
low-contrast image containing mostly dark pixels.
It was observed that a negative transform does nothing to improve the contrast,
because it doesn't shift pixel intensities relative to each other.
Power-law transformations can improve the contrast by non-linearly transforming
the intensity distribution to spread out pixels that have a small range of
intensities, so long as the exponent term is chosen so that the transformation occurs in
the right direction.
Histogram equalization automatically increases the contrast as much as possible,
but this can come at the expense of a realistic appearance for the image.

\section*{Appendix A: Source Code}
\lstset{
	language=Octave,
	% code font size
	basicstyle=\scriptsize,
	tabsize=2,
	breaklines=true,
	breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
	% show filename as title
	title=\lstname,
}

\lstinputlisting{part3.m}
\lstinputlisting{part4.m}
\lstinputlisting{part5.m}
\lstinputlisting{part6.m}

\end{document}
